<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>d3-voronoi-treemap usage</title>
    <meta name="description" content="d3-voronoi-treemap plugin to remake 'The Costs of Being Fat, in Actual Dollars'">
    <script src="src/d3.v6.min.js" charset="utf-8"></script>
    <script src="src/d3-weighted-voronoi.js"></script>
    <script src="src/d3-voronoi-map.js"></script>
    <!-- <script src="https://rawcdn.githack.com/Kcnarf/d3-voronoi-treemap/v1.1.1/build/d3-voronoi-treemap.js"></script> -->
    <script src="src/textures.js"></script>
    <script src="src/anychart-base.min.js"></script>
    <script src="/d3-voronoi-treemap-master/build/d3-voronoi-treemap.js"></script>
    <script src="src/seedrandom.min.js"></script>
    <!-- <script src="/d3-voronoi-treemap-master/build/d3-voronoi-treemap.min.js"></script> -->
    <!-- <script src="/d3-voronoi-treemap-master/src/d3-voronoi-treemap.js"></script> -->
    <style>
      svg {
        background-color: rgb(250,250,250);
      }
      
      #title {
        letter-spacing: 4px;
        font-weight: 700;
        font-size: x-large;
      }
      
      text.tiny {
        font-size: 10pt;
      }
      text.light {
        fill: lightgrey
      }
      
      .world {
        stroke: lightgrey;
		    stroke-width: 4px;
      }
      
      .cell {
        stroke: white;
        stroke-width: 1px;
      }
      
      .label {
        text-anchor: middle;
        /* fill: white; */
        
      }
      
       .label>.name {
        dominant-baseline: text-after-edge;
      }
      
      .label>.value {
        dominant-baseline: text-before-edge;
      }
      
      .hoverer {
        fill: transparent;
        stroke: white;
        stroke-width:0px;
      }
      
      .hoverer:hover {
        stroke-width: 3px;
      }
      
      .legend-color {
        stroke-width: 1px;
        stroke:darkgrey;
      }
    </style>
  </head>
  <body>
    <div id="div_container">
      <div id="div_header">
        <button onclick="window.location.href='barchart.html'" type="button">条形图</button>
      </div>

      <div id="div_map">
       
      </div>

      <div id="div_legends">
      </div>
    </div>
 



  </body>



  

    <svg width="1" height="1">
      <defs>
          <pattern id="img_France" width="100%" height="100%" patternContentUnits="objectBoundingBox">
              <image width="1" height="1" xlink:href="img/法国.png"/>
          </pattern>
          <pattern id="img_Brazil" width="100%" height="100%" patternContentUnits="objectBoundingBox">
            <image width="1" height="1" xlink:href="img/巴西.png"/>
          </pattern>
          <pattern id="img_England" width="100%" height="100%" patternContentUnits="objectBoundingBox">
            <image width="1" height="1" xlink:href="img/英格兰.png"/>
          </pattern>
          <pattern id="img_Argentina" width="100%" height="100%" patternContentUnits="objectBoundingBox">
            <image width="1" height="1" xlink:href="img/阿根廷.png"/>
          </pattern>
          <pattern id="img_Netherlands" width="100%" height="100%" patternContentUnits="objectBoundingBox">
            <image width="1" height="1" xlink:href="img/荷兰.png"/>
          </pattern>
          <pattern id="img_Croatia" width="100%" height="100%" patternContentUnits="objectBoundingBox">
            <image width="1" height="1" xlink:href="img/克罗地亚.png"/>
          </pattern>
          <pattern id="img_Morocco" width="100%" height="100%" patternContentUnits="objectBoundingBox">
            <image width="1" height="1" xlink:href="img/摩洛哥.png"/>
          </pattern>
          <pattern id="img_Portuguesa" width="100%" height="100%" patternContentUnits="objectBoundingBox">
            <image width="1" height="1" xlink:href="img/葡萄牙.png"/>
          </pattern>

        <pattern id="img2_France" width="100%" height="100%" patternContentUnits="objectBoundingBox">
            <image width="1" height="1" xlink:href="img/法国国旗.png"/>
        </pattern>
        <pattern id="img2_Brazil" width="100%" height="100%" patternContentUnits="objectBoundingBox">
          <image width="1" height="1" xlink:href="img/巴西国旗.png"/>
        </pattern>
        <pattern id="img2_England" width="100%" height="100%" patternContentUnits="objectBoundingBox">
          <image width="1" height="1" xlink:href="img/英格兰国旗.png"/>
        </pattern>
        <pattern id="img2_Argentina" width="100%" height="100%" patternContentUnits="objectBoundingBox">
          <image width="1" height="1" xlink:href="img/阿根廷国旗.png"/>
        </pattern>
        <pattern id="img2_Netherlands" width="100%" height="100%" patternContentUnits="objectBoundingBox">
          <image width="1" height="1" xlink:href="img/荷兰国旗.png"/>
        </pattern>
        <pattern id="img2_Croatia" width="100%" height="100%" patternContentUnits="objectBoundingBox">
          <image width="1" height="1" xlink:href="img/克罗地亚国旗.png"/>
        </pattern>
        <pattern id="img2_Morocco" width="100%" height="100%" patternContentUnits="objectBoundingBox">
          <image width="1" height="1" xlink:href="img/摩洛哥国旗.png"/>
        </pattern>
        <pattern id="img2_Portuguesa" width="100%" height="100%" patternContentUnits="objectBoundingBox">
          <image width="1" height="1" xlink:href="img/葡萄牙国旗.png"/>
        </pattern>
        <pattern id="img_cup" width="100%" height="100%" patternContentUnits="objectBoundingBox">
          <image width="1" height="1" xlink:href="img/cup.jpg"/>
        </pattern>
      </defs>
    </svg>
    
    <script>
     //console.log(Math.sqrt(9)) 
      //begin: constants
      var _2PI = 2*Math.PI;
      //end: constants
      
      //begin: layout conf.
      var svgWidth = 1300,
          svgHeight = 1300,
          margin = {top: 10, right: 10, bottom: 10, left: 10},
          height = svgHeight - margin.top - margin.bottom,
          width = svgWidth - margin.left - margin.right,
          halfWidth = width/2,
          halfHeight = height/2,
          quarterWidth = width/4,
          quarterHeight = height/4,
          titleY = 20,
          legendsMinY = height - 20,
          treemapRadius = 410,
          treemapCenter = [halfWidth, halfHeight+5];
      //end: layout conf.
      
      //begin: treemap conf.
      var _voronoiTreemap = d3.voronoiTreemap();
      var hierarchy, circlingPolygon;
      //end: treemap conf.
      
      //begin: drawing conf.
      var fontScale = d3.scaleLinear();
      //end: drawing conf.
      





      //begin: reusable d3Selection
      var svg, drawingArea, treemapContainer;
      //end: reusable d3Selection
      
      d3.json("noposition5.json").then(function(rootData) {
        initData();
        initLayout(rootData);
        //console.log(rootData)
        hierarchy = d3.hierarchy(rootData)
       .sum(function(d){ return d.value; }); // assigns the adequate weight to each node of the d3-hierarchy
        //console.log(hierarchy) //此处已经有内部形状坐标？？why？



        var leaves=hierarchy.leaves();
        //console.log(leaves)

        console.log(leaves)



        var AllMySeeds=['a','b','c','d','e','f','g','h','i','g']
        var index1=Math.trunc(Math.random()*10-1)
        var index2=Math.trunc(Math.random()*10-1)
        var index3=Math.trunc(Math.random()*10-1)
        var index4=Math.trunc(Math.random()*10-1)
        var index5=Math.trunc(Math.random()*10-1)
        //console.log(AllMySeeds[index1])
        var MySeed=AllMySeeds[index1]+AllMySeeds[index2]+AllMySeeds[index3]+AllMySeeds[index4]+AllMySeeds[index5]
        //console.log(MySeed)
        //var mySeededPrng = new Math.seedrandom("dgbib");
        // mySeededPrng = new Math.seedrandom(MySeed);
        //var ran=Math.random
        //console.log(circlingPolygon)//points所定义的轮廓坐标 

        function load(){
          var AllMySeeds=['a','b','c','d','e','f','g','h','i','g']
        var index1=Math.trunc(Math.random()*10-1)
        var index2=Math.trunc(Math.random()*10-1)
        var index3=Math.trunc(Math.random()*10-1)
        var index4=Math.trunc(Math.random()*10-1)
        var index5=Math.trunc(Math.random()*10-1)
        var index6=Math.trunc(Math.random()*10-1)
        var index7=Math.trunc(Math.random()*10-1)
        var index8=Math.trunc(Math.random()*10-1)
        var index9=Math.trunc(Math.random()*10-1)
        var index10=Math.trunc(Math.random()*10-1)
        //console.log(AllMySeeds[index1])
        var MySeed=AllMySeeds[index1]+AllMySeeds[index2]+AllMySeeds[index3]+AllMySeeds[index4]+AllMySeeds[index5]+
        AllMySeeds[index6]+AllMySeeds[index7]+AllMySeeds[index8]+AllMySeeds[index9]+AllMySeeds[index10]
        console.log(MySeed)
        //var mySeededPrng = new Math.seedrandom("dadhd");//布局1 
        //var mySeededPrng = new Math.seedrandom("acagc");//布局2
        //var mySeededPrng = new Math.seedrandom("hcidi");//布局3
        var mySeededPrng = new Math.seedrandom("fcgfebigea")
        //mySeededPrng = new Math.seedrandom(MySeed);
        //var ran=Math.random
        //console.log(circlingPolygon)//points所定义的轮廓坐标 
          _voronoiTreemap
          .clip(circlingPolygon)
          .prng(mySeededPrng)
          //.extent([[0, 410.00000000000006],[699.9137802864867, 120.08621971351778]]) //剪裁为矩形
        	(hierarchy);
        }



        load();



          // do {
          // load();

          // var flag0=0
          //    if(leaves[90].parent.polygon.site.x>300&&leaves[90].parent.polygon.site.x<500&&leaves[90].parent.polygon.site.y>300&&leaves[90].parent.polygon.site.y<500
          //    &&leaves[90].parent.polygon.site.neighbours.length==7
          //    ){
          //       flag0=1

          //     }
          //     var flag1=0
          //     for(i=0;i<leaves[140].parent.polygon.site.neighbours.length;i++){
          //         if(leaves[90].parent.polygon.site.x>300&&leaves[140].parent.polygon.site.neighbours[i].x==leaves[40].parent.polygon.site.x){
          //                flag1=1;
          //       }
          //     }
          //     var flag2=0
          //     for(i=0;i<leaves[40].parent.polygon.site.neighbours.length;i++){
          //         if(leaves[40].parent.polygon.site.x>300&&leaves[40].parent.polygon.site.neighbours[i].x==leaves[5].parent.polygon.site.x){
          //                flag2=1;
          //       }
          //     }
          //      var flag3=0
          //     for(i=0;i<leaves[5].parent.polygon.site.neighbours.length;i++){
          //         if(leaves[5].parent.polygon.site.neighbours[i].x==leaves[60].parent.polygon.site.x){
          //                flag3=1;
          //       }
          //     }

          //     var flag4=0
          //     for(i=0;i<leaves[60].parent.polygon.site.neighbours.length;i++){
          //         if(leaves[60].parent.polygon.site.neighbours[i].x==leaves[180].parent.polygon.site.x){
          //                flag4=1;
          //       }
          //     }
          //     var flag5=0
          //     for(i=0;i<leaves[180].parent.polygon.site.neighbours.length;i++){
          //         if(leaves[180].parent.polygon.site.neighbours[i].x==leaves[170].parent.polygon.site.x){
          //                flag5=1;
          //       }
          //     }
          //     console.log(flag0,flag1,flag2,flag3,flag4,flag5)
          // } 
          // while (flag0*flag1*flag2*flag3*flag4*flag5==0);
          
      



        drawTreemap(hierarchy);


        

        
      });
      
      function initData(rootData) {
        circlingPolygon = computeCirclingPolygon(treemapRadius);
        fontScale.domain([1, 80]).range([0.1, 10])
        .clamp(true);
        newpo=computeCirclingPolygon(430);
        console.log(newpo)
      }
      
      function computeCirclingPolygon(radius) {
        var points = 500,    //可调节轮廓形状
            increment = _2PI/points,
            circlingPolygon = [];
        
        for (var a=0, i=0; i<points; i++, a+=increment) {
          circlingPolygon.push(
            [radius + radius*Math.cos(a), radius + radius*Math.sin(a)]
          )
        }
        
      	return circlingPolygon;
      };
      
      
      function initLayout(rootData) {
        svg_map = d3.select("#div_map").append("svg")
        .attr("width",svgWidth)
        .attr("height", svgHeight)
        // svg = d3.select("svg")
        //   .attr("width", svgWidth)
        //   .attr("height", svgHeight);


        
        drawingArea = svg_map.append("g")
        	.classed("drawingArea", true)
        	.attr("transform", "translate("+[margin.left,margin.top]+")");

          
        
        treemapContainer = drawingArea.append("g")
        	.classed("treemap-container", true)
        	.attr("transform", "translate("+treemapCenter+")");
        
        treemapContainer.append("path")
        	.classed("world", true)
        	.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+")")
        	.attr("d", "M"+circlingPolygon.join(",")+"Z");







        treemapContainer.append("rect")
        .attr("transform", "translate("+[-treemapRadius,-treemapRadius]+")")
        .style("transform-box","fill-box")
          .style("transform-origin","center")
        	.attr("y", 690)
          .attr("x", 883+20)
        	.attr("width", 40)
        	.attr("height", 40)
        	.style("fill", function(d){ return ("url(#img_cup)" )});



        drawTitle();
        drawFooter();
        drawLegends(rootData);
        

        //treemapContainer.append("button")

      }
      
      function drawTitle() {
        drawingArea.append("text")
        	.attr("id", "title")
        	.attr("transform", "translate("+[halfWidth, titleY]+")")
        	.attr("text-anchor", "middle")
          //.text("世界杯8强球队")
      }
      
      function drawFooter() {
        drawingArea.append("text")
        	.classed("tiny light", true)
        	.attr("transform", "translate("+[0, height]+")")
        	.attr("text-anchor", "start")
        	//.text("Remake of HowMuch.net's article 'The Global Economy by GDP'")
        drawingArea.append("text")
        	.classed("tiny light", true)
        	.attr("transform", "translate("+[halfWidth, height]+")")
        	.attr("text-anchor", "middle")
        	//.text("by @_Kcnarf")
        drawingArea.append("text")
        	.classed("tiny light", true)
        	.attr("transform", "translate("+[width, height]+")")
        	.attr("text-anchor", "end")
        	//.text("bl.ocks.org/Kcnarf/fa95aa7b076f537c00aed614c29bb568")
      }
      

      // //var d1 = document.getElementById("d1");//获取div元素
      // var im = document.createElement("img");//创建图片
      // im.src = "img/1.png";
      // //图片设置成和div一样大小
      // im.style.width = d1.style.width;
      // im.style.height = d1.style.height ;
      // d1.appendChild(im);	//图片挂载到div上

 function ComputePoint(xx,yy,r){

 }



      function drawLegends(rootData) {



        var legendHeight = 13,
            interLegend = 4,
            colorWidth = legendHeight*6,
            continents = rootData.children.reverse();
            console.log(rootData.children)
        
        var legendContainer = drawingArea.append("g")
        	.classed("legend", true)
        	.attr("transform", "translate("+[0, legendsMinY]+")");
        
        var legends = legendContainer.selectAll(".legend")
        	.data(continents)
        	.enter();
        
        var legend = legends.append("g")
        	.classed("legend", true)
        	.attr("transform", function(d,i){
            return "translate("+[1136 -i*(colorWidth*2+5),-117]+")";
          })
          legend.append("rect")
        	//.classed("legend-color", true)
        	.attr("y", -legendHeight)
          
        	.attr("width", colorWidth/5)
        	.attr("height", legendHeight)
        	.style("fill", function(d){ return ("url(#img_"+d.name2+")" )});	


        legend.append("rect")
        	.classed("legend-color", true)
        	.attr("y", -legendHeight)
          .attr("x", colorWidth/5+3)
        	.attr("width", colorWidth/3)
        	.attr("height", legendHeight)
        	.style("fill", function(d){ return d.color; });

          console.log(d3.selectAll(".legend-color"))

        legend.append("text")
        	.classed("tiny", true)
        	.attr("transform", "translate("+[colorWidth-27, -2]+")")
          .attr("id",function(d,i) {return "text_" + i;})
        	.text(function(d){ return d.name; });

          //console.log(d3.select("#text_7"))


          // legend.append("rect")
        	
        	// .attr("y", -legendHeight)
          // .attr("x", function(d){ return (colorWidth+d.len-24) })
        	// .attr("width", colorWidth/5)
        	// .attr("height", legendHeight)
        	// .style("fill", function(d){ return ("url(#img2_"+d.name2+")" )});	
        



        
        legendContainer.append("text")
        	.attr("transform", "translate("+[15, -continents.length*(legendHeight+interLegend)-5]+")")
          .text("Teams");

          
      }
      
      function drawTreemap(hierarchy) {
        //console.log(hierarchy)
        var leaves=hierarchy.leaves();
        //console.log(leaves)  //polygon中有各个顶点的坐标


        var cells = treemapContainer.append("g")
        	.classed('cells', true)
        	.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+")")
	        .selectAll(".cell")
        	.data(leaves)
        	.enter()
        		.append("path")
        			.classed("cell", true)
        			.attr("d", function(d){ return "M"+d.polygon.join(",")+"z"; })
              //.attr("filter","url(#f1)")
        			.style("fill", function(d){
                return d.parent.data.color;
          		})
              // .call(t)
              // .style("fill", t.url())
              .attr("id",function(d,i) {return "cell_" + i;})
               ;
              var AllCell = d3.selectAll('.cell')

              var cells2 = treemapContainer.append("g")
        	.classed('cells2', true)
        	.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+")")
	        .selectAll(".cell2")
        	.data(leaves)
        	.enter()
        		.append("path")
        			.classed("cell2", true)
        			.attr("d", function(d){ return "M"+d.polygon.join(",")+"z"; })
              //.attr("filter","url(#f1)")
        			.style("fill", function(d){
                return d.parent.data.color;
          		})
              // .call(t)
              // .style("fill", t.url())
              .attr("id",function(d,i) {return "cell2_" + i;})
               ;

              // console.log(AllCell._groups[0]);
             
              // console.log(leaves[180].parent.polygon.site);//England
              // console.log(leaves[160].parent.polygon.site);  //Brazil
              // console.log(leaves[130].parent.polygon.site);  //France
              // console.log(leaves[110].parent.polygon.site);  //putaoya
              // console.log(leaves[90].parent.polygon.site);  //agenting
              // console.log(leaves[60].parent.polygon.site); //helan
              // console.log(leaves[30].parent.polygon.site);  //keluodiya
    
              // console.log(leaves[0].parent.polygon.site); //moluoge

              console.log(leaves[180].parent);//England
              console.log(leaves[160].parent);  //Brazil
              console.log(leaves[130].parent);  //France
              console.log(leaves[110].parent);  //putaoya
              console.log(leaves[90].parent);  //agenting
              console.log(leaves[60].parent); //helan
              console.log(leaves[30].parent);  //keluodiya
    
              console.log(leaves[0].parent); //moluoge



              for(var k=0;k<AllCell._groups[0].length;k++)
              {
              d3.select('svg').append('filter').attr('id','f'+k)
              d3.select("#f"+k)
                .append('feGaussianBlur').attr('in','SourceGraphic').attr('stdDeviation',leaves[k].data.var*3)
              }
                
                

              
              
              var myCons=1.7

                for(var k=0;k<AllCell._groups[0].length;k++)
              {
              let cell_brightness = document.querySelector("#cell_"+k);

              //if(leaves[k].parent.data.name2=="France"&&)




              
			        var color = d3.color(leaves[k].parent.data.color);

              if(leaves[k].data.mean!=null){
              //var color = color.brighter(1+(1-leaves[k].data.score1/myCons));
              var color = color.brighter(leaves[k].data.mean/myCons-3.7);
			        // cell_brightness.style.fill =
			        // `rgb(${color.r},${color.g},${color.b})`;color
              var color2=`rgb(${color.r},${color.g},${color.b})`

              }


              
              //d3.select("#cell_"+k).attr("background-color",color2);
              d3.select("#cell_"+k).style("fill",color2);
              d3.select("#cell_"+k).attr("filter","url(#f"+k+")");
              
              }

              for(var k=0;k<AllCell._groups[0].length;k++){
              //   var t = textures.lines()
              // .thinner((1-leaves[k].parent.data.delta_r/10)+1.2)
              // //.orientation("diagonal")
              // //.size(18)//阴影整体缩放
              // .strokeWidth(1)//阴影线条粗细
              // .stroke("grey")
              // //.background("none");


              var t = textures.paths()
              .d(s =>
              `M 0,${s * 3 / 4} 

                `
              )
              .thinner((1-leaves[k].parent.data.delta_r/10)+1.2)
              //.size(100)
              .strokeWidth(1)//阴影线条粗细
              .stroke("grey")

if (leaves[k].parent.data.name2=="France"||leaves[k].parent.data.name2=="Portuguesa"){
  var t = textures.paths()
              .d(s =>
              `M 0,${s * 3 / 4} 

                `
              )
              .thinner((1-leaves[k].parent.data.delta_r/10)+1.2)
              .strokeWidth(1)//阴影线条粗细
              .stroke("#53565c")
}


              if(leaves[k].parent.data.delta_r>=0){
                svg_map.call(t);
                
               d3.select("#cell2_"+k).style("fill",t.url());
                
              }

              var t3 = textures.paths()

  // .d(s =>
  // `M ${s / 4},${s / 4} 
  //   l ${s / 2},${s / 2} 
    
  //   M ${s *3/ 4},${s *3/ 4}
  //   l 0,${-s / 4}
  //   M ${s *3/ 4},${s *3 / 4}
  //   l ${-s / 4},0
  //   `
  //   )

  .d(s =>
  `M ${s / 4},${s / 4} 
     `
    )
              
              .thinner((1+leaves[k].parent.data.delta_r/10)+1.2)
              //.orientation("diagonal")
              //.size(20)
              .strokeWidth(1)
              //.thicker(2)
              //.background(color2)
              .stroke("grey");
              
              if (leaves[k].parent.data.name2=="England"){
  var t3 = textures.paths()
  .d(
    s =>
  `M ${s / 4},${s / 4} 

    `
    )
              .thinner((1-leaves[k].parent.data.delta_r/10)+1.2)
              .strokeWidth(1)//阴影线条粗细
              .stroke("#53565c")
}


              if(leaves[k].parent.data.delta_r<0){
                svg_map.call(t3);
              //cell_brightness.style.fill= t3.url();
              d3.select("#cell2_"+k).style("fill",t3.url());
              }
              }
              
 


        var labels = treemapContainer.append("g")
        	.classed('labels', true)
        	.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+")")
	        .selectAll(".label")
        	.data(leaves)
        	.enter()
        		.append("g")
        			.classed("label", true)
        			.attr("transform", function(d){
          			return "translate("+[d.polygon.site.x, d.polygon.site.y]+")";
              })
              .style("fill", function(d){ return d.parent.data.font_color})
              //.style("fill", "white")
        			.style("font-size", function(d){ return fontScale(d.data.value/2); });
        
        labels.append("text")
        	.classed("name", true)
          
        	.html(function(d){
          	return (d.data.value<1)? d.data.code : d.data.name;
        	});
        // labels.append("text")
        // 	.classed("value", true)
        // 	.text(function(d){ return d.data.value+"%"; });
        
        var hoverers = treemapContainer.append("g")
        	.classed('hoverers', true)
        	.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+")")
	        .selectAll(".hoverer")
        	.data(leaves)
        	.enter()
        		.append("path")
        			.classed("hoverer", true)
              .attr("id",function(d,i) {return "hov_" + i;})
        			.attr("d", function(d){ return "M"+d.polygon.join(",")+"z"; });
        
        hoverers.append("title")
          .text(function(d) { return d.data.name + "\n" + "身价："+d.value+"万欧元"+ "\n" + "评分方差："+d.data.var+ "\n" + "评分均值："+d.data.mean+ "\n" + "名次差："+d.parent.data.delta_r; });

          treemapContainer.append("path")
          .attr("transform", "translate("+[-treemapRadius,-treemapRadius]+") ")
          .attr("d","M410 410 L 720 710 L 720 710")
          .attr('fill','none')
          .attr("stroke","grey")


var data =[
  [35,33,34,34,32,33,29,28,28,24,24,22,23,22,11], //Morocco 
  [11,11,14,14,18,17,18,15,15,15,16,15,15,12,7],//Croatia
  [14,14,16,16,12,11,11,10,10,10,10,8,8,8,6],//Netherlands
  [7,7,8,8,6,6,6,5,5,4,4,3,3,3,2],//Argentina
  [5,5,5,5,8,7,8,8,8,8,8,9,9,9,9],//protuguesa
  [2,2,2,2,3,4,3,3,3,3,3,4,4,4,3],//France
  [3,3,3,3,2,2,2,2,2,2,1,1,1,1,1], //brazil
  [4,4,4,4,4,3,5,4,4,5,5,5,5,5,5],//England

 
]



  
var parentcolor=['rgb(134,39,33)','rgb(236,28,35)','rgb(242,107,23)','rgb(159,205,238)','rgb(0,139,69)',"rgb(50,107,199)",'rgb(245,209,0)','rgb(150,150,150)']
function dataNormalization(data){
var m = 8;
var  n = 15;
let arr = []; // create an empty array of length n
for (var k = 0; k < m; k++) {
  arr[k] = []; // make each element an array
}
console.log(arr); //  Output: [ [ <5 empty items> ], [ <5 empty items> ], [ <5 empty items> ], [ <5 empty items> ] ]
  for(i=0;i<8;i++){
    var data_sorted = data[i].sort(d3.ascending);
    for(j=0;j<15;j++){
      arr[i][j]=(36-data_sorted[j]-1)/(34)
    }
    
  }
return(arr)
}
newdata=dataNormalization(data)
console.log(newdata)

var positionArrold=[


[[380-1353,330-1353],180,117,"④","⑧(4.57%)","Morocco"],
[[380-1303,330-1303],-270,158,"③","⑦(6.29%)","Croatia"],
[[380-1180,330-1180],390,90,"⑤","⑥(9.51%)","Netherlands"],
[[710-30,760-30],845,0,"①","⑤(11.16%)","Argentina"],
[[-480+393,-530+393 ],-520,-104,"⑧","④(13.69%)","Portuguesa"],
[[-480-60,-530-60 ],-600,-152,"②","③(16.64%)","France"],
[[-480+685,-530+685],-25,-50,"⑦","②(18.03%)","Brazil"],
[[-480+315,-530+315],600,24,"⑥","①(20.12%)","England"]
]


// var positionArr=[[[610,510],132,-142,"④","4.57","Morocco"],
// [[leaves[30].parent.polygon.site.y+50,leaves[30].parent.polygon.site.y-50],leaves[30].parent.polygon.site.x,-104,"③","6.29","Croatia"],
// [[leaves[60].parent.polygon.site.y+50,leaves[60].parent.polygon.site.y-50],leaves[60].parent.polygon.site.x,-60,"⑤","9.51","Netherlands"],
// [[leaves[90].parent.polygon.site.y+50,leaves[90].parent.polygon.site.y-50],leaves[90].parent.polygon.site.x,-300,-13,"①","11.16","Argentina"],
// [[leaves[110].parent.polygon.site.y+50,leaves[110].parent.polygon.site.y-50],leaves[110].parent.polygon.site.x,-200,37,"⑧","13.69","Portuguesa"],
// [[leaves[130].parent.polygon.site.y+50,leaves[130].parent.polygon.site.y-50],leaves[130].parent.polygon.site.x,90,"②","16.64","France"],
// [[leaves[160].parent.polygon.site.y+50,leaves[160].parent.polygon.site.y-50],leaves[160].parent.polygon.site.x,158,"⑦","18.03","Brazil"],
// [[leaves[180].parent.polygon.site.y+50,leaves[180].parent.polygon.site.y-50],leaves[180].parent.polygon.site.x,0,"⑥","20.12","England"]]

var positionArr=[[[610,510],527,-142,"④","4.57","Morocco","摩洛哥"],
[[610,510],leaves[30].parent.polygon.site.x,-104,"③","6.29","Croatia","克罗地亚"],
[[610,510],leaves[60].parent.polygon.site.x,-60,"⑤","9.51","Netherlands","荷兰"],
[[610,510],leaves[90].parent.polygon.site.x,-300,"①","11.16","Argentina","阿根廷"],
[[610,510],leaves[110].parent.polygon.site.x,-200,"⑧","13.69","Portuguesa","葡萄牙"],
[[610,510],leaves[130].parent.polygon.site.x,90,"②","16.64","France","法国"],
[[610,510],leaves[160].parent.polygon.site.x,158,"⑦","18.03","Brazil","巴西"],
[[610,510],-598,0,"⑥","20.12","England","英格兰"]]

for(i=0;i<8;i++){
  var data_sorted = newdata[i].sort(d3.ascending)
console.log(data_sorted)
var q1 = d3.quantile(data_sorted, .25)
var median = d3.quantile(data_sorted, .5)
var q3 = d3.quantile(data_sorted, .75)
var interQuantileRange = q3 - q1
//console.log(interQuantileRange)
// var min = q1 - 1.5 * interQuantileRange
// var max = q3 + 1.5 * interQuantileRange

var min = data_sorted[0]
var max = data_sorted[14]

var Allmin = positionArr[i][0][0]
var Allmax = positionArr[i][0][1]

//var min =data_sorted[0]
//var max =data_sorted[14]

// Show the Y scale
var y = d3.scaleLinear()
  .domain([0,1])
  .range(positionArr[i][0]);
  //treemapContainer.call(d3.axisLeft(y))
//svg.call(d3.axisLeft(y))
console.log(positionArr[i][5]+"   IQR:"+interQuantileRange+"   (q1-1.5IQR):"+min,"  (q3+1.5IQR):"+max,"   q1:"+q1,"   q3:"+q3)

// a few features for the box
var center = positionArr[0][1]-160.8*i
var width = 20

// Show the main vertical line
treemapContainer
.append("line")
.attr("class","boxplot_" + i)
  .attr("x1", center)
  .attr("x2", center)
  .attr("y1", y(min) )
  .attr("y2", y(max) )
  .attr("stroke", "grey")

//   treemapContainer
// .append("line")
// .attr("class","boxplot_" + i)
//   .attr("x1", center)
//   .attr("x2", center)
//   .attr("y1", Allmin)
//   .attr("y2",Allmax)
//   .attr("stroke", "red")


// Show the box
treemapContainer
.append("rect")
.attr("class","boxplot_" + i)
  .attr("x", center - width/2)
  .attr("y", y(q3) )
  .attr("height", y(q1)-y(q3) )
  .attr("width", width )
  .attr("stroke", "grey")
  .style("fill", parentcolor[i])

// show median, min and max horizontal lines
treemapContainer
.selectAll("toto")

.data([min, median, max])
.enter()
.append("line")
  .attr("x1", center-width/2)
  .attr("x2", center+width/2)
  .attr("y1", function(d){ return(y(d))} )
  .attr("y2", function(d){ return(y(d))} )
  .attr("stroke", "grey")
.attr("class","boxplot_" + i)


// treemapContainer
// .selectAll("toto")
// .data([Allmax,Allmin])
// .enter()
// .append("line")
//   .attr("x1", center-width/2)
//   .attr("x2", center+width/2)
//   .attr("y1", function(d){ return(d)} )
//   .attr("y2",function(d){ return(d)} )
//   .attr("stroke", "red")
//   .attr("stroke-width",2)
// .attr("class","boxplot_" + i)






var center = positionArrold[i][1]
var width = 20
var y = d3.scaleLinear()
  .domain([0,1])
  .range(positionArrold[i][0]);

  treemapContainer.append("text")
         
         .attr("class","boxplot2_" + i)

       .attr("x", center-68).attr("y", y(min)).style("fill", "grey")
       .text(positionArrold[i][4])

       treemapContainer.append("text")
         
         .attr("class","boxplot2_" + i)

       .attr("x", center-103).attr("y", y(min)).style("fill", "grey").style('font-size',"12")
       .text("排名: ")

       treemapContainer.append("text")
         //.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+") rotate(-142)")
         .attr("class","boxplot2_" + i)
         //.attr("class","agentingtext")
         //.style("transform-box","fill-box")
         //.style("transform-origin","center")
       .attr("x", center-38).attr("y", y(min)-20).style("fill", "grey")
       .style('font-size',"12")
       .text("身价：")


       treemapContainer.append("text")
         //.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+") rotate(-142)")
         .attr("class","boxplot2_" + i)
         //.style("transform-box","fill-box")
         //.style("transform-origin","center")
       .attr("x",center+38).attr("y", y(min)).style("fill", "grey")
       .style('font-size',"16")
       .text(positionArrold[i][3])

       treemapContainer.append("text")
         //.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+") rotate(-142)")
         .attr("class","boxplot2_" + i)
         // .style("transform-box","fill-box")
         // .style("transform-origin","center")
       .attr("x",center+23).attr("y", y(min)-20).style("fill", "grey")
       .style('font-size',"12")
       .text("世界杯")

       treemapContainer.append("text")
         //.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+") rotate(-142)")
         .attr("class","boxplot2_" + i)
         // .style("transform-box","fill-box")
         // .style("transform-origin","center")
       .attr("x",center-103).attr("y", y(min)-35).style("fill", "grey")
       .style('font-size',"12")
       .text(positionArr[i][6])

       treemapContainer.append("rect")
       .attr("transform", "translate("+[0,0]+") rotate(-60)")
      //  .style("transform-box","fill-box")
      //    .style("transform-origin","center")
         .attr("class","boxplot2_" + i)
         .attr("x", center-103)
         .attr("y", y(min)-32)
         .attr("width", 20)
         .attr("height", 20)
         .style("fill", function(d){ return ("url(#img2_"+positionArrold[i][5] +")")});

        d3.selectAll(".boxplot_"+i)

        d3.selectAll(".boxplot2_"+i).attr("transform", "translate("+[-treemapRadius,-treemapRadius]+") rotate("+positionArrold[i][2]+")")
var defs = treemapContainer.append("defs");
//添加marker标签及其属性
var arrowMarker = defs.append("marker")
    .attr("id","arrow")
    .attr("markerUnits","strokeWidth")
    .attr("markerWidth",12)
    .attr("markerHeight",12)
    .attr("viewBox","0 0 12 12")
    .attr("refX",6)
    .attr("refY",6)
    .attr("orient","auto")
	//绘制直线箭头
var arrow_path = "M2,2 L10,6 L2,10 L6,6 L2,2";
arrowMarker.append("path")
    .attr("d",arrow_path)
    .attr("fill","#53565c")

    var arrowMarker2 = defs.append("marker")
    .attr("id","arrow2")
    .attr("markerUnits","strokeWidth")
    .attr("markerWidth",12)
    .attr("markerHeight",12)
    .attr("viewBox","0 0 12 12")
    .attr("refX",6)
    .attr("refY",6)
    .attr("orient","auto")
	//绘制直线箭头
var arrow_path = "M2,2 L10,6 L2,10 L6,6 L2,2";
arrowMarker2.append("path")
    .attr("d",arrow_path)
    .attr("fill","rgb(150,150,150)")

    var arrowMarker3 = defs.append("marker")
    .attr("id","arrow3")
    .attr("markerUnits","strokeWidth")
    .attr("markerWidth",12)
    .attr("markerHeight",12)
    .attr("viewBox","0 0 12 12")
    .attr("refX",6)
    .attr("refY",6)
    .attr("orient","auto")
	//绘制直线箭头
var arrow_path = "M2,2 L10,6 L2,10 L6,6 L2,2";
arrowMarker3.append("path")
    .attr("d",arrow_path)
    .attr("fill","rgb(100,149,237)")

// //绘制直线
// var theta=0.6/4*Math.PI
// var lineLength=120
// var x1=-234
// var y1=-200
// var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1+Math.cos(theta)*lineLength)
//     .attr("y2",y1+Math.sin(theta)*lineLength)
//     .attr("stroke","#53565c")
//     .attr("stroke-width",2)
//     //.attr("marker-start","url(#arrow)")
//     .attr("marker-end","url(#arrow)")

//     treemapContainer.append("text")

// .attr("x",x1-5).attr("y",y1-5).style("fill", "#53565c")
// .style('font-size',"22")
// .text("1")
//     treemapContainer.append("text")

//         .attr("x",x1+Math.cos(theta)*lineLength+10).attr("y",y1+Math.sin(theta)*lineLength+10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("7")

// treemapContainer.append("text")
// .attr("x",x1+Math.cos(theta)*lineLength/2).attr("y",y1+Math.sin(theta)*lineLength/2).style("fill", "#53565c")
// .style('font-size',"22")
// .text("-6")





//         var theta=0.1/4*Math.PI
// var lineLength=20
// var x1=124
// var y1=-230
// var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1+Math.cos(theta)*lineLength)
//     .attr("y2",y1+Math.sin(theta)*lineLength)
//     .attr("stroke","#53565c")
//     .attr("stroke-width",2)
//     //.attr("marker-start","url(#arrow)")
//     .attr("marker-end","url(#arrow)")

//     treemapContainer.append("text")

//         .attr("x",x1+Math.cos(theta)*lineLength+10).attr("y",y1+Math.sin(theta)*lineLength+10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("6")
//         treemapContainer.append("text")
//         .attr("x",x1-12).attr("y",y1+10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("5")
//         treemapContainer.append("text")
//         .attr("x",x1+Math.cos(theta)*lineLength/2-10).attr("y",y1+Math.sin(theta)*lineLength/2-10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("-1")




//         var theta=-0.2/4*Math.PI
// var lineLength=40
// var x1=-100
// var y1=270
// var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1+Math.cos(theta)*lineLength)
//     .attr("y2",y1+Math.sin(theta)*lineLength)
//     .attr("stroke","#53565c")
//     .attr("stroke-width",2)
//     //.attr("marker-start","url(#arrow)")
//     .attr("marker-end","url(#arrow)")

//     treemapContainer.append("text")

//         .attr("x",x1+Math.cos(theta)*lineLength+10).attr("y",y1+Math.sin(theta)*lineLength+10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("2")
// treemapContainer.append("text")
// .attr("x",x1+Math.cos(theta)*lineLength/2).attr("y",y1+Math.sin(theta)*lineLength/2-5).style("fill", "#53565c")
// .style('font-size',"22")
// .text("2")
// treemapContainer.append("text")
// .attr("x",x1-15).attr("y",y1+10).style("fill", "#53565c")
// .style('font-size',"22")
// .text("4")



        
//         var theta=-0.1/4*Math.PI
// var lineLength=20
// var x1=-280
// var y1=50
// var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1+Math.cos(theta)*lineLength)
//     .attr("y2",y1+Math.sin(theta)*lineLength)
//     .attr("stroke","#53565c")
//     .attr("stroke-width",2)
//     //.attr("marker-start","url(#arrow)")
//     .attr("marker-end","url(#arrow)")

//     treemapContainer.append("text")

//         .attr("x",x1+Math.cos(theta)*lineLength+10).attr("y",y1+Math.sin(theta)*lineLength+10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("8")
// treemapContainer.append("text")
// .attr("x",x1+Math.cos(theta)*lineLength/2).attr("y",y1+Math.sin(theta)*lineLength/2-5).style("fill", "#53565c")
// .style('font-size',"22")
// .text("1")
// treemapContainer.append("text")
// .attr("x",x1-15).attr("y",y1+10).style("fill", "#53565c")
// .style('font-size',"22")
// .text("9")

//         var theta=-0.2/4*Math.PI
// var lineLength=40
// var x1=70
// var y1=70
// var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1+Math.cos(theta)*lineLength)
//     .attr("y2",y1+Math.sin(theta)*lineLength)
//     .attr("stroke","#53565c")
//     .attr("stroke-width",2)
//     //.attr("marker-start","url(#arrow)")
//     .attr("marker-end","url(#arrow)")

//     treemapContainer.append("text")

//         .attr("x",x1+Math.cos(theta)*lineLength+10).attr("y",y1+Math.sin(theta)*lineLength+10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("1")
// treemapContainer.append("text")
// .attr("x",x1+Math.cos(theta)*lineLength/2).attr("y",y1+Math.sin(theta)*lineLength/2-5).style("fill", "#53565c")
// .style('font-size',"22")
// .text("2")
// treemapContainer.append("text")
// .attr("x",x1-15).attr("y",y1+10).style("fill", "#53565c")
// .style('font-size',"22")
// .text("3")

        
//         var theta=-0.3/4*Math.PI
// var lineLength=60
// var x1=280
// var y1=-30
// var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1+Math.cos(theta)*lineLength)
//     .attr("y2",y1+Math.sin(theta)*lineLength)
//     .attr("stroke","#53565c")
//     .attr("stroke-width",2)
//     //.attr("marker-start","url(#arrow)")
//     .attr("marker-end","url(#arrow)")

//     treemapContainer.append("text")

//         .attr("x",x1+Math.cos(theta)*lineLength+10).attr("y",y1+Math.sin(theta)*lineLength+10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("5")
// treemapContainer.append("text")
// .attr("x",x1+Math.cos(theta)*lineLength/2).attr("y",y1+Math.sin(theta)*lineLength/2-5).style("fill", "#53565c")
// .style('font-size',"22")
// .text("3")
// treemapContainer.append("text")
// .attr("x",x1-15).attr("y",y1+10).style("fill", "#53565c")
// .style('font-size',"22")
// .text("8")

//         var theta=-1.2/4*Math.PI
// var lineLength=110
// var x1=150
// var y1=290
// var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1+Math.cos(theta)*110)
//     .attr("y2",y1+Math.sin(theta)*110)
//     .attr("stroke","#53565c")
//     .attr("stroke-width",2)
//     //.attr("stroke-dasharray","10 10" )
//     //.attr("marker-start","url(#arrow)")
//     .attr("marker-end","url(#arrow)")

//     var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1-Math.cos(theta)*50)
//     .attr("y2",y1-Math.sin(theta)*50)
//     .attr("stroke-dasharray","10 10" )
//     .attr("stroke","#53565c")
//     .attr("stroke-width",2)



//     treemapContainer.append("text")

//         .attr("x",x1+Math.cos(theta)*lineLength-20).attr("y",y1+Math.sin(theta)*lineLength+10).style("fill", "#53565c")
//         .style('font-size',"22")
//         .text("3")
//         treemapContainer.append("text")

// .attr("x",x1-Math.cos(theta)*50+15).attr("y",y1-Math.sin(theta)*50).style("fill", "#53565c")
// .style('font-size',"22")
// .text("15")

// treemapContainer.append("text")

// .attr("x",x1+Math.cos(theta)*30-23).attr("y",y1+Math.sin(theta)*30).style("fill", "#53565c")
// .style('font-size',"22")
// .text("12")

//         var theta=-1.9/4*Math.PI
//         //console.log(Math.cos(theta))
// var lineLength=90
// var x1=290
// var y1=200
// var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1+Math.cos(theta)*90)
//     .attr("y2",y1+Math.sin(theta)*90)
//     .attr("stroke","rgb(150,150,150)")
//     .attr("stroke-width",2)
//     //.attr("stroke-dasharray","10 10" )
//     //.attr("marker-start","url(#arrow)")
//     .attr("marker-end","url(#arrow2)")

//     var line = treemapContainer.append("line")
//     .attr("x1",x1)
//     .attr("y1",y1)
//     .attr("x2",x1-Math.cos(theta)*30)
//     .attr("y2",y1-Math.sin(theta)*30)
//     .attr("stroke-dasharray","10 10" )
//     .attr("stroke","rgb(150,150,150)")
//     .attr("stroke-width",2)



//     treemapContainer.append("text")

//         .attr("x",x1+Math.cos(theta)*lineLength-17).attr("y",y1+Math.sin(theta)*lineLength+10).style("fill", "rgb(150,150,150)")
//         .style('font-size',"22")
//         .text("4")
//         treemapContainer.append("text")

// .attr("x",x1-Math.cos(theta)*30+10).attr("y",y1-Math.sin(theta)*30+18).style("fill","rgb(150,150,150)")
// .style('font-size',"22")
// .text("23")
// treemapContainer.append("text")

// .attr("x",x1+Math.cos(theta)*60-42).attr("y",y1+Math.sin(theta)*60+20).style("fill", "rgb(150,150,150)")
// .style('font-size',"22")
// .text("19")
}


function drawSpiral(){
  var dig=Math.PI/32;
var newjson = [];

  for (var i=42;i<=112;i++)

{
  var rowi = {};
  rowi.x= 140+30*i*dig*Math.sin(i*dig);

  rowi.y = 70+36*i*dig*Math.cos(i*dig);
  newjson.push(rowi);

  
 }
//  for (var i=100;i<=200;i++)

// {
//   var rowi = {};
//   rowi.x= 150+30*i*dig*Math.sin(i*dig);

//   rowi.y = 50+35*i*dig*Math.cos(i*dig);
//   newjson.push(rowi);

  
//  }

 data=[newjson]

//  data=[
//  [{"x": 303.379068458594, "y": 453.89741015538203},{"x": 499.00395395860187, "y": 667.8920458843986},{x: 677.3436351715807, y: 423.19197479315653},{x: 563.4632152425966, y: 180.41515552512396},{x: 330.2647137168551, y: 130.37211693793665},{x: 132.4152662001608, y: 257.3220419427545},{x: 76.21775200971098, y: 506.6823315354543},{x: 216.72986148852777, y: 704.7238440943349}]
//  ]
 
 console.log(data)
function MyLine(){
  let line = d3.line()
              .x(function(d){
                  //这个d就是咱们的data[0] 遍历的数据了 return也就是坐标 相当于帮咱们生成了一个 M0,0 L 1,2.....这个样
                return d.x
              })
              .y(function(d){
                return d.y
              })
              .curve(d3.curveCardinal)  //曲线效果
    
 treemapContainer.selectAll('path.pathhh')
     .data(data)
     .enter()
     .append('path')
     .attr('class','pathhh')
     .attr('d',function(d){
        return line(d)
      })
     .attr('stroke', 'rgb(100,149,237)')
     .style("stroke-width",4)
     .style("opacity",0.35)
     .attr('fill', 'none')
     .attr("marker-end","url(#arrow3)")
     //.attr("transform", "translate("+[-treemapRadius,-treemapRadius]+") ")


}
MyLine()
}

//drawSpiral()
console.log(d3.selectAll(".path"))

//for(k=0;k<8;k++){
function drawLineChart(k){
  var Mynewdata= [
    
    [{"y":"35","x":"1"},
{"y":"33","x":"2"},
{"y":"34","x":"3"},
{"y":"34","x":"4"},
{"y":"32","x":"5"},
{"y":"33","x":"6"},
{"y":"29","x":"7"},
{"y":"28","x":"8"},
{"y":"28","x":"9"},
{"y":"24","x":"10"},
{"y":"24","x":"11"},
{"y":"22","x":"12"},
{"y":"23","x":"13"},
{"y":"22","x":"14"},
{"y":"11","x":"15"}], //Morocco 
  [{"y":"11","x":"1"},
{"y":"11","x":"2"},
{"y":"14","x":"3"},
{"y":"14","x":"4"},
{"y":"18","x":"5"},
{"y":"17","x":"6"},
{"y":"18","x":"7"},
{"y":"15","x":"8"},
{"y":"15","x":"9"},
{"y":"15","x":"10"},
{"y":"16","x":"11"},
{"y":"15","x":"12"},
{"y":"15","x":"13"},
{"y":"12","x":"14"},
{"y":"7","x":"15"}],//Croatia
  [{"y":"14","x":"1"},
{"y":"14","x":"2"},
{"y":"16","x":"3"},
{"y":"16","x":"4"},
{"y":"12","x":"5"},
{"y":"11","x":"6"},
{"y":"11","x":"7"},
{"y":"10","x":"8"},
{"y":"10","x":"9"},
{"y":"10","x":"10"},
{"y":"10","x":"11"},
{"y":"8","x":"12"},
{"y":"8","x":"13"},
{"y":"8","x":"14"},
{"y":"6","x":"15"}],//Netherlands
  [{"y":"7","x":"1"},
{"y":"7","x":"2"},
{"y":"8","x":"3"},
{"y":"8","x":"4"},
{"y":"6","x":"5"},
{"y":"6","x":"6"},
{"y":"6","x":"7"},
{"y":"5","x":"8"},
{"y":"5","x":"9"},
{"y":"4","x":"10"},
{"y":"4","x":"11"},
{"y":"3","x":"12"},
{"y":"3","x":"13"},
{"y":"3","x":"14"},
{"y":"2","x":"15"}],//Argentina
  [{"y":"5","x":"1"},
{"y":"5","x":"2"},
{"y":"5","x":"3"},
{"y":"5","x":"4"},
{"y":"8","x":"5"},
{"y":"7","x":"6"},
{"y":"8","x":"7"},
{"y":"8","x":"8"},
{"y":"8","x":"9"},
{"y":"8","x":"10"},
{"y":"8","x":"11"},
{"y":"9","x":"12"},
{"y":"9","x":"13"},
{"y":"9","x":"14"},
{"y":"9","x":"15"}],//protuguesa
  [{"y":"2","x":"1"},
{"y":"2","x":"2"},
{"y":"2","x":"3"},
{"y":"2","x":"4"},
{"y":"3","x":"5"},
{"y":"4","x":"6"},
{"y":"3","x":"7"},
{"y":"3","x":"8"},
{"y":"3","x":"9"},
{"y":"3","x":"10"},
{"y":"3","x":"11"},
{"y":"4","x":"12"},
{"y":"4","x":"13"},
{"y":"4","x":"14"},
{"y":"3","x":"15"}],//France
  [{"y":"3","x":"1"},
{"y":"3","x":"2"},
{"y":"3","x":"3"},
{"y":"3","x":"4"},
{"y":"2","x":"5"},
{"y":"2","x":"6"},
{"y":"2","x":"7"},
{"y":"2","x":"8"},
{"y":"2","x":"9"},
{"y":"2","x":"10"},
{"y":"1","x":"11"},
{"y":"1","x":"12"},
{"y":"1","x":"13"},
{"y":"1","x":"14"},
{"y":"1","x":"15"}], //brazil
  [{"y":"4","x":"1"},
{"y":"4","x":"2"},
{"y":"4","x":"3"},
{"y":"4","x":"4"},
{"y":"4","x":"5"},
{"y":"3","x":"6"},
{"y":"5","x":"7"},
{"y":"4","x":"8"},
{"y":"4","x":"9"},
{"y":"5","x":"10"},
{"y":"5","x":"11"},
{"y":"5","x":"12"},
{"y":"5","x":"13"},
{"y":"5","x":"14"},
{"y":"5","x":"15"}]]//England
const height = 150, width =100, margin = 0;
  //定义咱们的svg画布空间容器


   //创建线性比例尺，使用坐标轴必备
  //const yScale = d3.scaleLinear().domain([10, 0]).range([0, width - margin * 2]);




 
  
    const yScale = d3.scaleLinear()
  .domain([35,1])
  .range([610,510]);
  var xScale = d3.scaleLinear().domain([1,15]).range([542-160.8*k,642-160.8*k]);

  //绘制一个横着的坐标轴
  function drawXAxis() {

      //创建底部的x的坐标轴
      const xAxis = d3.axisBottom(xScale).tickValues([1,5,10,15]);;

      //使坐标轴插入svg中
      treemapContainer.append('g')
      //.attr('class','x-axis')
      .attr('transform',function(){
          //让平移到底部x对的位置，咱们还要绘制y轴呢
          return `translate(${margin},610)`
      }).call(xAxis)
      //.append("text").text("price")
//       .attr("text-anchor","end")//字体尾部对齐
// .attr("dx","1em")//沿y轴平移一个字体的大小;
treemapContainer.append("text").attr("x",627-160.8*k).attr("y",603).attr("font-size",10).text("Time")

  }



   //绘制一个竖着的坐标轴
   function drawYAxis() {
      //创建底部的x的坐标轴
      const yAxis = d3.axisLeft(yScale);

      //使坐标轴插入svg中
      if(k<=4){
           treemapContainer.append('g').attr('class','y-axis').attr('transform',function(){
          //让平移到底部x对的位置，咱们还要绘制y轴呢
          return "translate("+(k*160.8+30)+`, ${ margin })`
      }).call(yAxis);
      treemapContainer.append('g').attr('class','y-axis').attr('transform',function(){
          //让平移到底部x对的位置，咱们还要绘制y轴呢
          return `translate(`+((-k)*160.8+30)+`, ${ margin })`
      }).call(yAxis);
      }
   
      // if(k>4){
      //     treemapContainer.append('g').attr('class','y-axis').attr('transform',function(){
      //     //让平移到底部x对的位置，咱们还要绘制y轴呢
      //     return `translate(`+(8-k)*160.8+`, ${ margin })`
      // }).call(yAxis);
      // }
      treemapContainer.append("text").attr("x",487-160.8*k).attr("y",508).attr("font-size",10).text("Ranking")
  }

var data = [
  Mynewdata[k]
  // ,
  // Mynewdata[6]
  //     d3.range(10).map(function(i){
  //         return {x:i,y:Math.min(i)}
  //     })
  ]
console.log(data)
    
  function drawLine() {
    console.log(data)
    
      //d3.line是把数组的坐标生成一个path路径
      let line = d3.line()
              .x(function(d){
                  //这个d就是咱们的data[0] 遍历的数据了 return也就是坐标 相当于帮咱们生成了一个 M0,0 L 1,2.....这个样
                return xScale(d.x)
              })
              .y(function(d){
                return yScale(d.y)
              })
              //.curve(d3.curveCardinal)  //曲线效果
    
              treemapContainer.selectAll('path.path')
     .data(data)
     .enter()
     .append('path')
     .attr('class','path'+k)
     .attr('d',function(d){
        return line(d)
      })
     .attr('stroke', '#2e6be6')
     .attr('fill', 'none')
     //.attr('transform',`translate(${margin}, ${margin})`)

     console.log(d3.selectAll('path.path'+k))
  }


drawXAxis();
drawYAxis();

drawLine();
    //await drawCircle();

  
  }
  for(p=0;p<8;p++){
   drawLineChart(p) 
  }
//drawLineChart(5) 


}

      //}
    </script>

</html>